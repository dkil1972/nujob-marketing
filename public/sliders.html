<html>
<head>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	 <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
	<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script>
	<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css"></link>
</head>
<body>
<h2>Recruiters vs NuJob</h2>

<p>Average salary:  &#163;<input data-bind="value: salary" /> Average recruiter margin: <input data-bind="value: recruiterMargin" style="width:50px" />%</p>

<p>
	Number of developers you need to hire:
	<input data-bind="value: devs, valueUpdate: 'afterkeydown'" />
	<div style="margin: 10px" data-bind="slider: devs, sliderOptions: {min: 0, max: 40, range: 'min', step: 1}"></div>
</p>

Number of months it might take: <input data-bind="value: monthsTaken, valueUpdate: 'afterkeydown'" />
<div style="margin: 10px" data-bind="slider: monthsTaken, sliderOptions: {min: 1, max: 24, range: 'min', step: 1}"></div>

<p>Total cost with a Recruiter: &#163;<span data-bind="text: recruiterCostRounded"></span></p>

<p>Total cost with NuJob plan 1: &#163;<span data-bind="text: nujobPlan1Cost"></span> (Saving of <b>&#163;<span data-bind="text: plan1Saving"></span></b>)</p>

<p>Total cost with NuJob plan 2: &#163;<span data-bind="text: nujobPlan2Cost"></span> (Saving of <b>&#163;<span data-bind="text: plan2Saving"></span></b>)</p>

<p>Total cost with NuJob plan 3: &#163;<span data-bind="text: nujobPlan3Cost"></span> (Saving of <b>&#163;<span data-bind="text: plan3Saving"></span></b>)</p>

<p>Total cost with NuJob plan 4: &#163;<span data-bind="text: nujobPlan4Cost"></span> (Saving of <b>&#163;<span data-bind="text: plan4Saving"></span></b>)</p>
</body>

<script>
ko.bindingHandlers.slider = {
  init: function (element, valueAccessor, allBindingsAccessor) {
    var options = allBindingsAccessor().sliderOptions || {};
    $(element).slider(options);
    ko.utils.registerEventHandler(element, "slidechange", function (event, ui) {
        var observable = valueAccessor();
        observable(ui.value);
    });
    ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
        $(element).slider("destroy");
    });
    ko.utils.registerEventHandler(element, "slide", function (event, ui) {
        var observable = valueAccessor();
        observable(ui.value);
    });
  },
  update: function (element, valueAccessor) {
    var value = ko.utils.unwrapObservable(valueAccessor());
    if (isNaN(value)) value = 0;
    $(element).slider("value", value);

  }
};


var ViewModel = function() {
    var self = this;
    
    self.salary = ko.observable(45000);
    self.monthsTaken = ko.observable(1);
    self.recruiterMargin = ko.observable(15);
    self.devs = ko.observable(0);

	self.recruiterCost = ko.computed(function() {
        return ((self.salary()/(1-(self.recruiterMargin()/100)))-self.salary())*self.devs();
    });
	self.recruiterCostRounded = ko.computed(function() {
		return Math.round(self.recruiterCost() / 100) * 100;
	});
    
	self.nujobPlan1Cost = ko.computed(function() {
        return (99 * self.monthsTaken());
    });

	self.nujobPlan2Cost = ko.computed(function() {
        return (299 * self.monthsTaken());
    });

	self.nujobPlan3Cost = ko.computed(function() {
        return (499 * self.monthsTaken());
    });

	self.nujobPlan4Cost = ko.computed(function() {
        return (1599 * self.monthsTaken());
    });

    self.plan1Saving = ko.computed(function() {
        return self.recruiterCostRounded() - self.nujobPlan1Cost();
    });

	self.plan2Saving = ko.computed(function() {
        return self.recruiterCostRounded() - self.nujobPlan2Cost();
    });

	self.plan3Saving = ko.computed(function() {
        return self.recruiterCostRounded() - self.nujobPlan3Cost();
    });

	self.plan4Saving = ko.computed(function() {
        return self.recruiterCostRounded() - self.nujobPlan4Cost();
    });
}

ko.applyBindings(new ViewModel());

</script>
</html>